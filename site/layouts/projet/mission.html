{{ define "main" }}
<div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.3.2/chart.min.js"></script>
    {{ partial "page-desc" . }}
    <div class="container pt-8 mb-8">
        <h2 class="uppercase text-rered text-center font-extrabold text-xl md:text-3xl mb-12 mt-4">{{ .Params.context_title }}</h2>
        <div class="px-8">
            <div class="w-full md:w-5/6 m-auto flex flex-col md:flex-row flex-wrap items-stretch text-white tracking-tight text-center">
                <div class="w-full bg-rered p-12 rounded-lg mb-4 flex flex-col items-center">
                    <h3 class="uppercase font-bold text-lg md:text-2xl mb-4">{{ .Params.context_definition_title }}</h3>
                    <p class="mb-4">{{ .Params.context_definition_text }}</p>
                    <img src="/img/page-mission/precarite.svg" alt=""/>
                </div>
                {{with .Params.context_first }}
                <div class="w-full md:w-1/2 pb-4 md:pb-0 flex flex-col md:pr-2">
                    <div class="h-full bg-reorange py-8 px-8 md:px-12 rounded-lg flex flex-col items-center">
                        {{ partial "projet/big-title-white" (dict "title" .title "size" "3xl") }}
                        <div class="markdown mt-4">{{.content | markdownify }}</div>
                        <img class="w-1/2 h-64 mt-4" src="{{.img}}" alt=""/>
                    </div>                    
                </div>
                {{end}}
                <div class="w-full md:w-1/2 flex flex-col md:pl-2">
                    {{with .Params.context_second }}
                    <div class="h-full bg-reorange py-8 px-8 md:px-12 rounded-lg flex flex-col items-center">
                        {{ partial "projet/big-title-white" (dict "title" .title "size" "3xl") }}
                        <div class="markdown mt-4">{{.content | markdownify }}</div>
                        <img class="w-1/2 h-64 mt-4" src="{{.img}}" alt=""/>                        
                    </div>                    
                    {{end}}
                </div>
                {{ range $i,$p := .Params.study }}
                <div class="w-full md:w-1/4 pt-4 {{ if eq $i 0 }} md:pr-2 {{ else if eq $i 3 }} md:pl-2 {{ else }} md:px-2 {{ end }}">
                    <div class="h-full bg-rered rounded-lg p-8">
                        <h3 class="uppercase font-bold text-3xl md:text-5xl">{{ $p.number }}</h3>
                        <p class="mt-4">{{ $p.text }}</p>
                        <p class="mt-4 italic"><a href="/actualites/2021-05-28_faire-couler-de-lencre/">{{ $.Params.study_source }}</a></p>
                    </div>
                </div>
                {{ end }}
            </div>
        </div>
    </div>

    <div class="w-11/12 md:w-5/6 mx-auto mt-16">
        <h1 class="text-center text-xl md:text-3xl mt-8 mb-2 uppercase font-extrabold text-rered px-8">{{.Params.numbers.title}}</h1>
        <p class="text-center text-rered px-8 font-medium tracking-tight">{{.Params.numbers.content}}</p>
        <div class="">
            <div class="flex flex-wrap justify-center">
                {{ range $elem_index, $elem_val := .Params.numbers.cards }}
                <div class="w-full sm:w-1/2 md:w-1/3 relative px-8 py-12">
                    <div class="absolute inset-x-0 px-8">
                        <div class="flex flex-col items-center w-full"><img class="h-32" src="{{ .img }}" alt=""/></div>
                    </div>
                    <div class="bg-reorange h-full text-white mt-16 pt-20 -mb-8 text-center rounded-lg px-4">
                        <h3 class="text-xl md:text-2xl font-bold">{{.number}}</h3>
                        <p class="font-medium mt-4">{{.desc}}</p>
                    </div>
                </div>
                {{end}}

                
            </div>
        </div>
        
        <div class="flex flex-col items-center mt-16 md:mt-32">
            <div class="w-full md:w-2/3 mx-auto">
                <h3 class="text-center text-rered md:text-lg font-medium tracking-tight mb-4">
                    {{.Params.collectes.title}}
                </h3>
                <canvas id="myChart" width="400" height="200"></canvas>
            </div>
            <a class="big-red-button big-red-button--rounded my-12" href="/projet/actions">
                {{ .Params.action_button }}
            </a>
        </div>    
        
    </div>

    <script>
        const data = {
            labels: [
                "Décembre 2015",
                "Mars 2016",
                "Mars 2017",
                "Mars 2018",
                "Décembre 2018",
                "Mars 2019",
                "Juin 2019",
                "Juillet 2019",
                "Décembre 2019",
                "Mars 2020",
                "Octobre 2020",
                "Janvier 2021",
                "Juin 2021"
            ],
            datasets: [
                {
                    label: 'Nombre de produits collectés',
                    data: [20000, 50000, 100000, 200000, 300000, 400000, 600000, 1200000, 1500000, 3600000, 4000000, 5000000, 5500000],
                    borderColor: "#e9364b",
                    backgroundColor: "#FFE4DD",
                    fill: "start",
                    tension: 0.1
                }
            ]
        };

        var ctx = document.getElementById('myChart');
        var myChart = new Chart(ctx, {
            type: 'line',
            data: data,
            options: {
                plugins: {
                    filler: {
                        propagate: false,
                    },
                    title: {
                        display: false,
                        text: "Produits d'hygiène intime collectés par Règles Élémentaires"
                    },
                    legend: {
                        display: false,
                    }
                },
                interaction: {
                    intersect: false,
                },
                scales: {
                    x: {
                        ticks: {
                            color: '#e9364b',
                        },
                        grid: {
                            display: false,
                            drawBorder: false
                        }
                    },
                    y: {
                        ticks: {
                            color: '#e9364b'
                        },
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });
    </script>
</div>
{{ end }}